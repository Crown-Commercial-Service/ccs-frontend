(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1315:function(e,t,o){"use strict";const{registerReducer:n,registerEpics:r}=o(4),i=o(1377),a=o(2204),{bookShelfSetupEpic:l,registerTrackingMapEpic:s,saveTrackingEpic:c}=o(2205);n("bookShelf",a),r(l,s,c,i("bookShelf"))},1377:function(e,t,o){"use strict";const n=o(8),{Observable:r}=o(5),{setLocationReadyState:i,PUSH_LOCATION:a}=o(9),l=o(303),s=o(218);e.exports=(e,t)=>(o,c)=>o.filter(({type:t})=>{if(t!==a)return;const{navigationStatus:o,path:n}=c.getState().location;return"plugin"===o&&n[0]===e}).switchMap(()=>{const o=c.getState(),{device:a,course:d}=o;let h;if(h=t?t(o):n(d,["_"+e,"_heroImage"]),!h||!h._graphic)return r.empty();const p=l(h._graphic.src,h._graphic.srcAdvanced,!0);return p?r.concat(r.of(i(!1)),r.bindCallback(s)(p,!1).map(()=>i(!0))):r.empty()})},1379:function(e,t,o){"use strict";const n=o(8),{store:r}=o(4);e.exports=function(e,t,o){const{course:i,theme:a}=r.getState(),l=i[e],s=n(l,t),c=n(a,["_extensions",e,"_settings",t]);return s||c||o}},2204:function(e,t,o){"use strict";const n=o(10),{SETUP_APP:r}=o(9),i={_isEnabled:!1};e.exports=(e=i,t)=>{if(t.type===r){const o=t.payload.course._bookShelf;return o&&o._isEnabled?n({},e,o):i}return e._isEnabled?(t.type,e):i}},2205:function(e,t,o){"use strict";const n=o(8),{Observable:r}=o(5),{registerTrackingMap:i}=o(4),{SETUP_APP:a}=o(9),{addElement:l}=o(42),{NavigationSideItem:s}=o(475),c=o(1379),{UPDATE_ARTICLE:d}=o(79),{trackerSaveSession:h}=o(484),p=o(2206),m=o(2207),u=o(2208);t.bookShelfSetupEpic=(e,t)=>e.filter(e=>{var o;const n=t.getState();return e.type===a&&(null==n||null===(o=n.bookShelf)||void 0===o?void 0:o._isEnabled)}).mergeMap(()=>{const e=t.getState(),{bookShelf:o}=e,i=l({parent:"navigationSide",name:"bookShelf",component:s,props:{link:"/bookShelf",icon:c("_bookShelf","_navigationIcon","bookmark"),label:o.title}}),a=l({parent:"article",name:"bookShelf",component:p,position:"actionBar",props:{ariaLabel:o.shelveButtonAriaLabel}}),d=l({parent:"router",name:"bookShelf",path:"/bookShelf",exact:!0,component:m,getShouldPersist:e=>n(e,"course._bookShelf._isEnabled",!1)});return r.of(i,a,d)}),t.registerTrackingMapEpic=(e,t)=>e.filter(e=>{if(e.type!==a)return!1;const{bookShelf:o}=t.getState();return o&&o._isEnabled}).do(()=>{i("bookShelf",u,"extensions")}).ignoreElements(),t.saveTrackingEpic=(e,t)=>e.filter(e=>{var o;return e.type===d&&((null===(o=t.getState().bookShelf)||void 0===o?void 0:o._isEnabled)&&e.payload._bookShelf)}).mergeMap(()=>r.of(h()))},2206:function(e,t,o){"use strict";const n=o(2),r=o(0),{connect:i}=o(6),a=o(7),{updateArticle:l}=o(79),s=n({displayName:"BookShelfArticleButton",onClick(e){e.preventDefault();const{article:t}=this.props;let o=t._bookShelf._isShelved;o=!o,this.props.updateArticle({_id:t._id,_bookShelf:{...t._bookShelf,_isShelved:o}})},render(){var e;const{article:t}=this.props;if(null==t||null===(e=t._bookShelf)||void 0===e||!e._isEnabled)return null;const o=t._bookShelf._isShelved;return r.createElement("div",{className:"ev-article-action-bar-item"},r.createElement("button",{className:"ev-button ev-chromeless",onClick:this.onClick,"aria-label":this.props.ariaLabel,"aria-pressed":o},r.createElement("i",{className:a("ev-icon",{"ev-icon-bookmark":o,"ev-icon-book2":!o})})))}});e.exports=i(null,{updateArticle:l})(s)},2207:function(e,t,o){"use strict";const n=o(32),r=o(2),i=o(1),a=o(0),{connect:l}=o(6),s=o(7),c=o(33),d=o(24),h=o(521),p=o(174),{ContentContainer:m,HeroImage:u}=o(302),b=o(62),v=r({displayName:"BookShelf",propTypes:{bookShelf:i.shape({title:i.string,body:i.string,noItemsText:i.string,ariaLabel:i.string,_headerIcon:i.string,_heroImage:i.object}).isRequired,articles:i.array.isRequired,theme:i.object.isRequired,isReady:i.bool.isRequired},renderTitle(){const{bookShelf:e}=this.props;return e.title?a.createElement("div",{className:"ev-header-title"},a.createElement(d,{element:"h1",className:"ev-header-title-inner",html:e.title})):null},renderBody(){const{bookShelf:e}=this.props;return e.body?a.createElement(c,{className:"ev-header-body",innerClassName:"ev-header-body-inner",body:e.body}):null},renderNoItems(){const{bookShelf:e,articles:t}=this.props;return t.length?null:a.createElement("div",{className:"ev-content"},a.createElement("div",{className:"ev-content-inner"},a.createElement("div",{className:"ev-content-row"},a.createElement("div",{className:"ev-content-row-inner"},a.createElement("div",{className:"ev-component-container"},a.createElement("div",{className:"ev-component"},a.createElement("div",{className:"ev-component-inner"},a.createElement(c,{className:"ev-component-body",innerClassName:"ev-component-body-inner",body:e.noItemsText}))))))))},renderArticles(){const{articles:e}=this.props;return e.length?e.map(e=>a.createElement(h,{key:e._id,articleId:e._id})):null},renderHeroImage(){const e=this.props.bookShelf._heroImage;if(null!=e&&e._isEnabled)return a.createElement(b.Provider,{value:this.props.bookShelf.title?2:1},a.createElement(u,{title:e.title,body:e.body,graphic:e._graphic,_contentWidth:e._contentWidth,layout:e.layout,floatingGraphic:e._floatingGraphic,parentSelector:".ev-extension-hero-container",theme:this.props.theme,isReady:this.props.isReady}))},render(){var e,t,o,n;const{props:r}=this,i=null===(e=r.bookShelf)||void 0===e?void 0:e._headerIcon,l=null===(t=r.theme._extensions)||void 0===t||null===(o=t._bookShelf)||void 0===o||null===(n=o._settings)||void 0===n?void 0:n._headerIcon,c=i||l;return a.createElement(m,{region:"bookshelf",className:"ev-extension ev-bookShelf",ariaLabel:r.bookShelf.ariaLabel},a.createElement("div",{className:"ev-extension-inner"},r.isReady?null:a.createElement(p,null),a.createElement("div",{className:"ev-extension-hero-container"},this.renderHeroImage()),a.createElement("div",{className:"ev-header"},a.createElement("div",{className:s("ev-header-inner ev-clearfix",{"ev-no-graphic":!c})},a.createElement("div",{className:"ev-header-left"},this.renderTitle(),this.renderBody()),c&&a.createElement("div",{className:"ev-header-right"},a.createElement("i",{className:"ev-icon ev-icon-"+c})))),a.createElement(b.Provider,{value:2},this.renderNoItems(),this.renderArticles())))}});e.exports=l(e=>({bookShelf:e.bookShelf,theme:e.theme,isReady:e.location.isLocationReady,articles:n(e.articles,({_bookShelf:e})=>(null==e?void 0:e._isEnabled)&&(null==e?void 0:e._isShelved))}))(v)},2208:function(e,t,o){"use strict";const n=o(11),{store:r}=o(4),{updateArticle:i}=o(79);e.exports={_articles:{fieldKey:"_articles",type:"Function",shouldRestore:!0,mapCallback:function(){const{articles:e}=r.getState(),t={};return n(e,e=>{var o;null!=e&&null!==(o=e._bookShelf)&&void 0!==o&&o._isEnabled&&(t[e._id]={_isShelved:e._bookShelf._isShelved})}),t},restoreCallback:function(e){const{articles:t}=r.getState();n(e._articles,(e,o)=>{const n=t[o];n&&r.dispatch(i({_id:o,_bookShelf:{...null==n?void 0:n._bookShelf,...e}}))})}}}}}]);