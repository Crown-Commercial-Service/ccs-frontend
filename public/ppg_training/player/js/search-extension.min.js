(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{1334:function(e,t,s){"use strict";const{registerEpics:r,registerReducer:i}=s(4),{setupSearchEpic:n,searchChangedEpic:a,syncMenuFilterEpic:c}=s(2323),l=s(2337);r(n,a,c),i("search",l)},1482:function(e,t,s){var r=s(314),i=s(485),n=s(497),a=s(124),c=s(180),l=s(315);e.exports=function(e,t,s,o){var u=-1,h=i,d=!0,p=e.length,g=[],m=t.length;if(!p)return g;s&&(t=a(t,c(s))),o?(h=n,d=!1):t.length>=200&&(h=l,d=!1,t=new r(t));e:for(;++u<p;){var _=e[u],y=null==s?_:s(_);if(_=o||0!==_?_:0,d&&y==y){for(var E=m;E--;)if(t[E]===y)continue e;g.push(_)}else h(t,y,o)||g.push(_)}return g}},1483:function(e,t,s){var r=s(65),i=s(49);e.exports=function(e){return i(e)&&r(e)}},1496:function(e,t,s){"use strict";const{store:r}=s(4),i=s(516);e.exports=function(e,t){t||(t=r.getState());const s=[];return function e(t,s,r){const n=i(t,s);return r.push(n),"course"!==n._type&&e(n,s,r),r}(e,t,s),s}},1497:function(e,t,s){"use strict";t.SEARCH_VALUE_CHANGED="SEARCH_VALUE_CHANGED",t.SEARCH_TAGS_CHANGED="SEARCH_TAGS_CHANGED",t.NEW_SEARCH_RESULTS="NEW_SEARCH_RESULTS",t.MENU_FILTER_CHANGED="MENU_FILTER_CHANGED",t.RESOURCE_FILTER_CHANGED="RESOURCE_FILTER_CHANGED",t.searchValueChanged=e=>({type:t.SEARCH_VALUE_CHANGED,payload:e}),t.searchTagsChanged=e=>({type:t.SEARCH_TAGS_CHANGED,payload:e}),t.menuFilterChanged=e=>({type:t.MENU_FILTER_CHANGED,payload:e}),t.resourceFilterChanged=e=>({type:t.RESOURCE_FILTER_CHANGED,payload:e})},1617:function(e,t,s){"use strict";const r=s(8),i=s(18),{store:n}=s(4),a=s(1496);e.exports=function(e,t){if(t=t||n.getState(),!r(t,"course._contentLocking._isEnabled",!1)||"course"===e._type)return!1;if(e._isLocked)return!0;const s=a(e,t);return void 0!==i(s,e=>e._isLocked)}},2323:function(e,t,s){"use strict";const r=s(18),{Observable:i}=s(5),{SETUP_APP:n,PUSH_LOCATION:a}=s(9),{addElement:c}=s(42),l=s(1496),o=s(2324),u=s(2326),h=s(2335),{SEARCH_VALUE_CHANGED:d,NEW_SEARCH_RESULTS:p,SEARCH_TAGS_CHANGED:g,MENU_FILTER_CHANGED:m,RESOURCE_FILTER_CHANGED:_,menuFilterChanged:y}=s(1497);t.setupSearchEpic=(e,t)=>e.filter(({type:e})=>{if(e===n){const{course:e}=t.getState();return e._search&&e._search._isEnabled}return!1}).mergeMap(()=>{const e=t.getState(),{course:s}=e,r=s._search;h.initialize(e);const n=void 0===r._isOnRightSide||r._isOnRightSide,a=n?"right":"left",l=n?8:0;return i.of(c({name:"searchButton",parent:"navigationTop",component:o,position:a,priority:l,props:{search:r}}),c({name:"searchPanel",parent:"container",component:u,props:{search:r}}),y(s._id))}),t.searchChangedEpic=(e,t)=>e.ofType(d,g,m,_).debounce(({type:e})=>i.timer(e===d?500:0)).map(()=>{const e=t.getState(),{searchValue:s,currentTags:r,currentResourceId:i}=e.search;let n=[];return(s||r.length||"NONE"!==i)&&(n=h.search(e)),{type:p,payload:n}}),t.syncMenuFilterEpic=(e,t)=>e.filter(({type:e})=>{if(e!==a)return;const{course:s}=t.getState(),r=s._search||{};return r._isEnabled&&r._isMenuFilterEnabled&&r._shouldSyncMenuFilter}).mergeMap(()=>{const e=t.getState(),{location:s,search:n,contentObjects:a,course:c}=e,{currentContentType:o,currentId:u}=s;let h;if("menu"===o)h=u;else if("page"===o){const t=l(a[u],e),s=r(t,{_type:"menu"});h=s?s._id:c._id}else h=c._id;return h&&h!==n.currentMenuId?i.of(y(h)):i.empty()})},2324:function(e,t,s){"use strict";const r=s(2),i=s(0),{connect:n}=s(6),a=s(307),{toggleActiveOverlay:c}=s(499),l=s(2325),o=r({displayName:"SearchButtonContainer",render(){return i.createElement(l,this.props)}});e.exports=n(e=>({isOpen:a("search",e),activeOverlay:e.overlay.activeOverlay}),{toggleActiveOverlay:c})(o)},2325:function(e,t,s){"use strict";var r=s(30)(s(21));const i=s(0),n=s(1),a=s(7),c=({isOpen:e,search:t,activeOverlay:s,toggleActiveOverlay:n})=>i.createElement("a",(0,r.default)({href:"#",tabIndex:s&&!e?"-1":"0",role:"button"},t.searchAriaLabel&&{"aria-label":t.searchAriaLabel},{"aria-expanded":e,className:"ev-search-button ev-navigation-item",onClick:e=>{e.preventDefault(),n("search")}}),i.createElement("i",{className:(()=>{const s="ev-icon-"+t._searchNavigationItemIcon;return a("ev-icon",{"ev-icon-cross":e,[s]:!e})})()}));c.propTypes={isOpen:n.bool.isRequired,search:n.object.isRequired,activeOverlay:n.string,toggleActiveOverlay:n.func.isRequired},e.exports=c},2326:function(e,t,s){"use strict";const r=s(2),i=s(0),{connect:n}=s(6),{toggleActiveOverlay:a}=s(499),c=s(307),l=s(2327),{menusSelector:o}=s(2334),{searchValueChanged:u,searchTagsChanged:h,menuFilterChanged:d,resourceFilterChanged:p}=s(1497),g=r({displayName:"SearchPanelContainer",render(){return i.createElement(l,this.props)}});e.exports=n((e,t)=>({isOpen:c("search",e),searchValue:e.search.searchValue,currentTags:e.search.currentTags,currentMenuId:e.search.currentMenuId,currentResourceId:e.search.currentResourceId,results:e.search.results,isSearching:e.search.isSearching,device:e.device,menus:o(e,t),navigation:e.navigation}),{searchValueChanged:u,toggleActiveOverlay:a,searchTagsChanged:h,menuFilterChanged:d,resourceFilterChanged:p})(g)},2327:function(e,t,s){"use strict";var r=s(30)(s(21));const i=s(31),n=s(8),a=s(2),c=s(1),l=s(0),o=s(7),u=s(64),h=s(144),d=s(2328),p=s(2329),g=s(2331),m=s(2333),_=a({displayName:"SearchPanel",propTypes:{isOpen:c.bool.isRequired,search:c.object.isRequired,searchValue:c.string.isRequired,searchValueChanged:c.func.isRequired,searchTagsChanged:c.func.isRequired,menuFilterChanged:c.func.isRequired,resourceFilterChanged:c.func.isRequired,results:c.array.isRequired,isSearching:c.bool.isRequired,toggleActiveOverlay:c.func.isRequired,device:c.object.isRequired,menus:c.array.isRequired,currentMenuId:c.string.isRequired,currentResourceId:c.string.isRequired,currentTags:c.array.isRequired},onItemClicked(){this.props.toggleActiveOverlay("search")},onTagChanged(e){this.props.searchTagsChanged(e)},onMenuFilterChanged(e){this.props.menuFilterChanged(e)},onResourceChanged(e){this.props.resourceFilterChanged(e)},getStyle:()=>({top:h()}),getHasNoResults(){const{isSearching:e,searchValue:t,currentTags:s,currentResourceId:r,results:i}=this.props;let n=!1;return e||i.length||!t&&!s.length&&"NONE"===r||(n=!0),n},renderSearchTagsPicker(){if(this.props.search._isSearchTagsEnabled)return l.createElement(g,{isVisible:this.props.isOpen,label:this.props.search.tagsLabelText,tags:this.props.search._tags,currentTags:this.props.currentTags,onTagChanged:this.onTagChanged})},renderMenuFilter(){const{props:e}=this;if(!e.search._isMenuFilterEnabled||e.menus.length<2)return;const t=i(e.menus,e=>({text:n(e,"_search.menuFilterText",e.displayTitle),value:e._id}));return l.createElement(m,{id:"ev-search-menus",label:e.search.menuFilterLabelText,options:t,value:e.currentMenuId,onChange:this.onMenuFilterChanged})},renderResourceFilter(){const{props:e}=this;if(!e.search._isResourcesEnabled)return;const t=i(e.search._resources,e=>({text:e.name,value:e._id}));return t.unshift({text:e.search.resourcesPlaceholderText||"",value:"NONE"}),l.createElement(m,{id:"ev-search-resources",label:e.search.resourcesLabelText,options:t,value:e.currentResourceId,onChange:this.onResourceChanged})},render(){const{props:e}=this,{search:t}=e;return l.createElement(u,(0,r.default)({name:"search",style:this.getStyle(),isVisible:e.isOpen,tabIndex:e.isOpen?0:-1},t.searchSidePanelAriaLabel&&{"aria-label":t.searchSidePanelAriaLabel},{"aria-hidden":!e.isOpen,className:o("ev-search-panel",{"ev-is-right":t._isOnRightSide,"ev-is-visible":e.isOpen})}),l.createElement("div",{className:"ev-search-panel-inner"},l.createElement(d,{value:e.searchValue,placeholder:t.searchInputPlaceholder,ariaLabel:t.searchInputAriaLabel,isOpen:e.isOpen,onChange:e.searchValueChanged}),this.renderSearchTagsPicker(),this.renderMenuFilter(),this.renderResourceFilter(),l.createElement(p,{results:e.results,onItemClicked:this.onItemClicked,windowHeight:e.device.windowHeight,noResultsText:t.noResultsText,isOpen:e.isOpen,isSearchTagsEnabled:t._isSearchTagsEnabled,tags:t._tags,hasNoResults:this.getHasNoResults()})))}});e.exports=_},2328:function(e,t,s){"use strict";var r=s(30)(s(21));const i=s(2),n=s(1),a=s(0),c=i({displayName:"SearchInput",propTypes:{onChange:n.func.isRequired,value:n.string.isRequired,placeholder:n.string.isRequired,ariaLabel:n.string,isOpen:n.bool.isRequired},componentDidUpdate({isOpen:e}){!e&&this.props.isOpen&&this._input&&this._input.focus()},onChange(e){this.props.onChange(e.target.value)},render(){const{props:e}=this;return a.createElement("div",{className:"ev-search-input"},a.createElement("input",(0,r.default)({ref:e=>this._input=e,type:"text",className:"ev-input-text",tabIndex:e.isOpen?"0":"-1",value:e.value},e.ariaLabel&&{"aria-label":e.ariaLabel},{placeholder:e.placeholder,onChange:this.onChange})))}});e.exports=c},2329:function(e,t,s){"use strict";const r=s(139),i=s(2),n=s(1),a=s(0),c=s(48),{Transition:l}=s(77),o=s(2330),u=i({displayName:"SearchResults",propTypes:{results:n.array.isRequired,onItemClicked:n.func.isRequired,windowHeight:n.number.isRequired,noResultsText:n.string.isRequired,hasNoResults:n.bool.isRequired,isOpen:n.bool.isRequired,tags:n.array.isRequired,isSearchTagsEnabled:n.bool.isRequired},getInitialState:()=>({height:window.innerHeight}),componentDidMount(){this.setHeight(this.props.windowHeight)},UNSAFE_componentWillReceiveProps(e){e.windowHeight!==this.props.windowHeight&&this.setHeight(e.windowHeight),e.results!==this.props.results&&(c.findDOMNode(this).scrollTop=0)},setHeight(e){const t=c.findDOMNode(this),{top:s}=t.getBoundingClientRect(),r=e-s;this.setState({height:r})},renderNoResults(){if(this.props.hasNoResults)return a.createElement("div",{className:"ev-search-no-results"},this.props.noResultsText)},renderResults(){const{props:e}=this,t=e.isOpen?"0":"-1",s=r(e.tags,"_id");return a.createElement(l,{keys:e.results.map(e=>e._id),items:e.results,from:{opacity:0,x:20},enter:{opacity:1,x:0},leave:{opacity:0,x:20}},r=>({opacity:i,x:n})=>a.createElement(o,{key:r._id,item:r,tabIndex:t,tags:s,shouldDisplayTags:e.isSearchTagsEnabled,onItemClicked:e.onItemClicked,styles:{opacity:i,transform:`translate3d(${n}%,0,0)`}}))},render(){return a.createElement("div",{className:"ev-search-results",style:{height:this.state.height}},this.renderNoResults(),a.createElement("ul",{className:"ev-search-results-list"},this.renderResults()))}});e.exports=u},2330:function(e,t,s){"use strict";const r=s(57),i=s(39),n=s(8),a=s(2),c=s(1),l=s(0),{Link:o}=s(34),u=s(24),h=a({displayName:"SearchResultItem",propTypes:{item:c.object.isRequired,tabIndex:c.string.isRequired,shouldDisplayTags:c.bool.isRequired,tags:c.object.isRequired,onItemClicked:c.func.isRequired,styles:c.object},renderTitle(){return l.createElement(u,{element:o,className:"ev-search-result-item-title",tabIndex:this.props.tabIndex,to:this.props.item.link,onClick:this.props.onItemClicked,html:this.props.item.title})},renderPageTitle(){if(this.props.item.pageTitle)return l.createElement("h6",{className:"ev-search-result-item-sub-title"},this.props.item.pageTitle)},renderBody(){if(this.props.item.body)return l.createElement(u,{className:"ev-search-result-item-body",html:this.props.item.body})},renderSearchText(){const{item:e}=this.props;if(e.searchText&&r(e.matchKeys,"searchText"))return l.createElement(u,{className:"ev-search-result-item-ev-search-text",html:e.searchText})},renderTags(){const{props:e}=this;if(!e.shouldDisplayTags)return;const t=i(e.tags).pick(n(e.item,"tagIds",[])).map(e=>l.createElement("li",{key:e._id,className:"ev-search-result-item-tag",style:{backgroundColor:e._color}},e.label)).value();return l.createElement("ul",{className:"ev-search-result-item-tags"},t)},render(){return l.createElement("li",{className:"ev-search-result-item",style:this.props.styles},this.renderTitle(),this.renderPageTitle(),this.renderBody(),this.renderSearchText(),this.renderTags())}});e.exports=h},2331:function(e,t,s){"use strict";const r=s(31),i=s(57),n=s(0),a=s(2),c=s(1),l=s(2332),o=a({displayName:"SearchTagsPicker",propTypes:{isVisible:c.bool.isRequired,label:c.string.isRequired,currentTags:c.arrayOf(c.string).isRequired,tags:c.arrayOf(c.shape({_id:c.string.isRequired,label:c.string.isRequired,_color:c.string.isRequired})).isRequired,onTagChanged:c.func.isRequired},renderSearchTagsPickerItems(){return r(this.props.tags,e=>n.createElement(l,{key:e._id,tag:e,isVisible:this.props.isVisible,isSelected:i(this.props.currentTags,e._id),onTagChanged:this.props.onTagChanged}))},render(){return n.createElement("fieldset",{className:"ev-search-tags-picker"},n.createElement("legend",{className:"ev-search-tags-picker-label"},this.props.label),this.renderSearchTagsPickerItems())}});e.exports=o},2332:function(e,t,s){"use strict";const r=s(0),i=s(2),n=s(1),a=s(7),c=i({displayName:"SearchTagsPickerItem",propTypes:{isVisible:n.bool.isRequired,isSelected:n.bool.isRequired,tag:n.object.isRequired,onTagChanged:n.func.isRequired},render(){const{props:e}=this;return r.createElement("div",{className:a("ev-search-tags-picker-item",{"ev-is-selected":e.isSelected})},r.createElement("input",{className:"ev-input-checkbox",type:"checkbox",id:e.tag._id,checked:e.isSelected,tabIndex:e.isVisible?0:-1,name:"ev-search-tags",onChange:()=>e.onTagChanged(e.tag._id)}),r.createElement("label",{htmlFor:e.tag._id},e.tag.label),r.createElement("span",{className:"ev-search-tags-picker-item-color",style:{backgroundColor:e.tag._color}}))}});e.exports=c},2333:function(e,t,s){"use strict";(function(t){const r=s(31),i=s(0),n=s(2),a=s(1),c=n({displayName:"SearchSelectFilter",propTypes:{id:a.string.isRequired,label:a.string.isRequired,options:a.array.isRequired,value:a.string.isRequired,onChange:a.func.isRequired},onChange({target:e}){this.props.onChange(e.value)},renderOptions(){const{options:e}=this.props;return r(e,e=>i.createElement("option",{key:e.value,value:e.value},t(`<div>${e.text}</div>`).text()))},render(){const{id:e,value:t,label:s}=this.props;return i.createElement("div",{className:"ev-search-select-filter"},i.createElement("label",{className:"ev-search-select-filter-label",htmlFor:e},s),i.createElement("select",{id:e,className:"ev-search-select-filter-select",value:t,onChange:this.onChange},this.renderOptions()))}});e.exports=c}).call(this,s(29))},2334:function(e,t,s){"use strict";const r=s(32),{createSelector:i}=s(56),n=s(1617);t.menusSelector=i([e=>e.contentObjects,e=>e.course],(e,t)=>{const s=r(e,e=>"menu"===e._type&&!n(e));return s.unshift(t),s})},2335:function(e,t,s){"use strict";const r=s(32),i=s(139),n=s(504),a=s(18),c=s(39),l=s(11),o=s(57),u=s(10),h=s(507),d=s(8),p=s(173),g=s(43),m=s(142),_=s(518),y=s(509),E=s(1617),R=s(480),b=s(1496),f=s(512),v=s(215),T=s(2336);let C;function S(e,t){const s=["_id","_refId","_type","_parentId"],r=[],i=t.course._search,n=i._shouldUseTitleIfNoDisplayTitle,c=i._shouldDisplayParentPage;return l(e,e=>{if(!(e.displayTitle||n||e.body||d(e,"_search.searchText")))return;const i=b(e,t),l=p(i,(e,t)=>("menu"===t._type&&e.push(t._id),e),[]),h=u(g(e,s),{title:R(e.displayTitle),body:R(e.body),link:f(e._refId),searchText:d(e,"_search.searchText",""),tagIds:d(e,"_search._searchTagIds",[]),menuIds:l});if(!h.title&&n&&(h.title=e.title),c&&o(["component","block","article"],e._type)){const e=a(i,e=>"page"===e._type);h.pageTitle=d(e,"_search.searchResultPageTitle",R(e.displayTitle))}r.push(h)}),r}function N(e="",t=[]){const s=[];let r=0;for(let i=0;i<t.length;i++){const[n,a]=t[i],c=d(t,[[i+1],0]),l=I(e,n,4),o=x(e,a,4);null!==l&&l>r&&(r=l,s.push("...")),s.push(e.substring(r,n)),s.push(`<span class="ev-search-highlight">${e.substring(n,a)}</span>`),i!==t.length-1?null!==o&&o<c?(s.push(e.slice(a,o)),r=o):r=a:o?s.push(e.slice(a,o)+"..."):s.push(e.slice(a))}return s.join("")}function I(e,t,s){const r=e.slice(0,t),{length:i}=r;let n=0,a=null;for(let e=i-1;e>0&&n!==s;e--)" "===r[e]&&(n++,n===s&&(a=e+1));return a}function x(e,t,s){const r=e.slice(t),{length:i}=r;let n=0,a=null;for(let e=0;e<i&&n!==s;e++)" "===r[e]&&(n++,n===s&&(a=e+t));return a}function A(e="",t){return e.length<=t?e:e.substr(0,e.lastIndexOf(" ",t))+"..."}t.initialize=function(e){const{course:t,components:s,blocks:i,articles:n,contentObjects:a}=e,c=t._search._searchableContent,o=[];if(c.component&&o.push(...S(s,e)),c.block&&o.push(...S(i,e)),c.article&&o.push(...S(n,e)),c.page){const t=r(a,e=>"page"===e._type);o.push(...S(t,e))}if(c.menu){const s=r(a,e=>"menu"===e._type);o.push(...S([t,...s],e))}c.extension&&o.push(...function(e){const t=[];return l(T,(s,r)=>{if(!d(e,[r,"_isEnabled"]))return;let i="";l(s.additionalFields,t=>{const s=e[r][t];s&&(i+=s+"...")}),t.push({_id:r,_type:"extension",title:R(e[r][s.title]),body:R(e[r][s.body]),searchText:R(i),link:s.link})}),t}(t)),C=o},t.search=function(e){const{search:t,course:s,isShowingHiddenContent:r}=e,{currentTags:p,currentMenuId:R,currentResourceId:b,searchValue:f}=t,T=i(p,e=>e);let S,I=f.replace("/","").trim();I&&s._search._isTokenized&&(I=n(I).join("|")),I&&(S=new RegExp(I,"gi"));const x=[];let O=C;if(s._search._isResourcesEnabled&&"NONE"!==b){const e=a(s._search._resources,{_id:b});e&&e._resourceIds&&(O=c(C).filter(e=>"extension"!==e._type).keyBy("_refId").pick(e._resourceIds).values().value())}return l(O,t=>{const i="extension"===t._type;if(!r&&!i&&v(t._refId,e)._isHidden)return;if(s._search._isSearchTagsEnabled&&p.length){if(i)return;if(!function(e,t){const s=d(e,"tagIds",[]),r=g(t,s);return!!m(r)}(t,T))return}if(s._search._isMenuFilterEnabled&&R!==s._id){if(i)return;if(!o(t.menuIds,R))return}if(!i&&E(v(t._refId,e),e))return;let n;if(I){const e=function(e,t){const s=["title","body","searchText"],r={matchKeys:[],matches:0,matchWords:0},i=[];for(let n=0;n<s.length;n++){const a=s[n],c=e[a],l=[];let o;for(;o=t.exec(c);){const e=o[0];i.push(_(e)),l.push([o.index,o.index+e.length])}l.length?(r.matchKeys.push(a),r[a]=N(c,l)):r[a]=A(c,50),r.matches+=l.length}return r.matchWords=y(i).length,r}(t,S);e.matches&&(n=u({},t,e))}else n=u({},t,{title:A(t.title,50),body:A(t.body,50),matchKeys:[]});n&&x.push(n)}),I?h(x,["matchWords","matches"],["desc","desc"]):x}},2336:function(e,t,s){"use strict";e.exports={_about:{title:"title",body:"description",additionalFields:["_aboutContent"],link:"/about"},_achievements:{title:"title",body:"body",link:"/achievements"},_courseAssessment:{title:"title",body:"body",link:"/courseAssessment/showResults"},_bookShelf:{title:"title",body:"body",link:"/bookShelf"},_glossary:{title:"title",body:"description",link:"/glossary"},_resources:{title:"title",body:"description",link:"/resources"},_tags:{title:"title",body:"body",additionalFields:["overviewTitle","overviewBody"],link:"/tags"}}},2337:function(e,t,s){"use strict";const r=s(10),i=s(57),n=s(2338),{SETUP_APP:a}=s(9),{SEARCH_VALUE_CHANGED:c,NEW_SEARCH_RESULTS:l,SEARCH_TAGS_CHANGED:o,MENU_FILTER_CHANGED:u,RESOURCE_FILTER_CHANGED:h}=s(1497),d={results:[],isSearching:!1,searchValue:"",currentTags:[],currentMenuId:"",currentResourceId:"NONE"};e.exports=(e=d,t)=>{switch(t.type){case a:return r({},d);case c:return r({},e,{searchValue:t.payload,isSearching:!0});case o:return r({},e,{currentTags:i(e.currentTags,t.payload)?n(e.currentTags,t.payload):[...e.currentTags,t.payload],isSearching:!0});case u:return r({},e,{currentMenuId:t.payload,isSearching:!0});case h:return r({},e,{currentResourceId:t.payload,isSearching:!0});case l:return r({},e,{results:t.payload,isSearching:!1});default:return e}}},2338:function(e,t,s){var r=s(1482),i=s(145),n=s(1483),a=i((function(e,t){return n(e)?r(e,t):[]}));e.exports=a}}]);