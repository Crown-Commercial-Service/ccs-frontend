(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{1306:function(e,t,n){"use strict";const{registerMenu:i}=n(4);i("mapMenu",n(2164))},1387:function(e,t,n){"use strict";e.exports=function(e){const t=e.displayTitle,n=e._heroImage?e._heroImage.title:null;return t||n}},2164:function(e,t,n){"use strict";const i=n(18),o=n(8),s=n(31),a=n(2),r=n(1),c=n(0),{connect:l}=n(6),u=n(7),{addPrompt:m}=n(474),{setAriaLive:p}=n(58),d=n(63),h=n(2165),g=n(2166),f=n(2167),v=n(2168),I=n(2169),M=n(144),_=n(226),b=n(478),y=a({displayName:"MapMenu",propTypes:{menu:r.object.isRequired,device:r.object.isRequired,theme:r.object.isRequired,itemIds:r.array.isRequired,course:r.object.isRequired,addPrompt:r.func.isRequired,hasActionBar:r.bool.isRequired},getInitialState:function(){return this.getDefaultState()},componentDidMount:function(){const{props:e}=this;e.menu.ariaLabel&&e.setAriaLive({message:e.menu.ariaLabel,delay:200}),this.checkMapMenuImage(),this.checkMapMenuPointerImages()},checkMapMenuImage:function(){this.getMapMenuGraphic()||this.showErrorPrompt("No map menu image was found!","Make sure you have set a map menu image in Evolve")},checkMapMenuPointerImages:function(){const{props:e}=this,t=this.getDefaultPointerImage();i(e.items,e=>!o(e,"_mapMenu._pointerImage")&&!t)&&this.showErrorPrompt("No default menu pointer image was found!","Make sure you have set a default menu pointer image in Evolve")},showErrorPrompt:function(e,t){this.props.addPrompt({title:e,body:t,_glyph:{_type:"icon",_className:"ev-icon-cross"}})},getDefaultState:function(){return{_isDragging:!1,_isShowingInfo:!1,_selectedItemId:null}},getClassName:function(){const{props:e,state:t}=this;return u("ev-map-menu ev-menu",e.classList,{"ev-is-dragging":t._isDragging,"ev-use-menu-header-styles":e.theme._menu._settings._useMenuHeaderStyles,"ev-disable-inner-flex":e.theme._footer._settings._isStickyFooterDisabled})},getDefaultPointerImage:function(){const{props:e}=this;return o(e.course,"_mapMenu._defaultPointerImage")},getCloseButtonText:function(){const{props:e}=this;return o(e.course,"_mapMenu._closeButtonText")},getIsModalOpen:function(){const{state:e}=this;return!(!e._isShowingInfo&&!e._selectedItemId)},getMenuBody:function(){const{props:e}=this;return"course"===e.menu._type?e.menu.body:e.menu.description},getMapMenuGraphic:function(){const{props:e}=this;return o(e.menu,"_mapMenu._mapImage")},onDragStart:function(){this.setState({_isDragging:!0})},onDragEnd:function(){this.setState({_isDragging:!1})},onPointerClick:function(e){this.setState({_selectedItemId:e._id,_isShowingInfo:!1})},onInfoClick:function(){this.setState({_isShowingInfo:!0,_selectedItemId:null})},onInfoCloseClick:function(){this.setState({_isShowingInfo:!1})},onCloseMenuItemClick:function(){this.setState({_selectedItemId:null})},renderTitle:function(){const{menu:e}=this.props;if(e.displayTitle&&o(e,"_mapMenu._shouldShowTitleBar",!0))return c.createElement(h,{title:e.displayTitle,body:this.getMenuBody(),infoOpenButtonAriaLabel:e._mapMenu.infoOpenButtonAriaLabel,onInfoClick:this.onInfoClick,isModalOpen:this.getIsModalOpen()})},renderItems:function(){const{props:e}=this,t=this.getDefaultPointerImage(),n=this.getIsModalOpen();return s(e.itemIds,i=>c.createElement(f,{key:i,itemId:i,defaultPointerImage:t,defaultPointerWidth:e.menu._mapMenu._defaultPointerWidth,isModalOpen:n,onClick:this.onPointerClick}))},renderMapMenuImage:function(){const{props:e,state:t}=this,n=this.getMapMenuGraphic();if(n)return c.createElement(g,{graphic:n,alt:e.menu._mapMenu.mapImageAltText,menuImageWidth:o(e,"menu._mapMenu._menuImageWidth",1024),menuScrollableContainerMaxWidth:o(e,"menu._mapMenu._menuScrollableContainerMaxWidth",1024),device:e.device,isModalOpen:this.getIsModalOpen(),isDragging:t._isDragging,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd},this.renderItems())},renderInfo:function(){if(this.state._isShowingInfo)return c.createElement(v,{body:this.getMenuBody(),closeButtonText:this.getCloseButtonText(),onInfoCloseClick:this.onInfoCloseClick})},getShouldShowProgressBars:function(){const{props:e}=this,t=o(e.theme,"_menu._settings._shouldShowProgressBarsOnMenus","content"),n=o(e.menu,"_mapMenu._shouldShowProgressBarsOnMenus",!0);return"content"===t?n:"true"===t},renderMenuItem:function(){const{state:e,props:t}=this,n=o(t.theme,"_menu._settings._durationIcon",null);if(e._selectedItemId)return c.createElement(I,{itemId:e._selectedItemId,closeButtonText:this.getCloseButtonText(),onCloseMenuItemClick:this.onCloseMenuItemClick,shouldShowProgressBarsOnMenus:this.getShouldShowProgressBars(),durationIcon:n})},renderActionBar:function(){if(this.props.hasActionBar)return c.createElement("div",{className:"ev-action-bar-container"},this.renderElements("actionBar"))},renderElements:function(e){const{elements:t,menu:n}=this.props;return d("menu",e,{menu:n})},render:function(){const e=M();return c.createElement(_,null,c.createElement("div",{className:this.getClassName()},b(this.props.menu),c.createElement("main",{className:"ev-menu-container ev-map-menu-container",style:{minHeight:`calc(100vh - ${e})`}},c.createElement("div",{className:"menu-root"},this.renderElements("root")),c.createElement("div",{className:"ev-menu-container-inner ev-map-menu-container-inner"},this.renderTitle(),this.renderMapMenuImage(),this.renderActionBar(),this.renderInfo(),this.renderMenuItem()),c.createElement("div",{className:"ev-menu-footer"},this.renderElements("footer")))))}});e.exports=l(null,{addPrompt:m,setAriaLive:p})(y)},2165:function(e,t,n){"use strict";const i=n(2),o=n(1),s=n(0),a=n(7),r=n(24),c=i({displayName:"MapMenuTitle",propTypes:{title:o.string.isRequired,body:o.string,onInfoClick:o.func.isRequired,isModalOpen:o.bool.isRequired,infoOpenButtonAriaLabel:o.string},onInfoClick:function(e){e.preventDefault(),e.currentTarget.blur(),this.props.onInfoClick()},renderInfoButton:function(){const{props:e}=this;if(e.body)return s.createElement("button",{className:a("ev-map-menu-button ev-map-menu-information-button",{"ev-disabled":e.isModalOpen}),disabled:e.isModalOpen,onClick:this.onInfoClick,"aria-label":e.infoOpenButtonAriaLabel},s.createElement("i",{className:"ev-icon ev-icon-question"}))},render:function(){const{props:e}=this;return s.createElement("div",{className:"ev-map-menu-title"},s.createElement("div",{className:"ev-map-menu-title-inner"},s.createElement(r,{element:"h1",html:e.title}),this.renderInfoButton()))}});e.exports=c},2166:function(e,t,n){"use strict";(function(t){const i=n(2),o=n(1),s=n(0),a=n(48),r=n(7),c=n(477),l=n(119),u=i({displayName:"MapMenuImage",propTypes:{graphic:o.object.isRequired,device:o.object.isRequired,isModalOpen:o.bool.isRequired,isDragging:o.bool.isRequired,onDragStart:o.func.isRequired,onDragEnd:o.func.isRequired,menuImageWidth:o.number.isRequired,menuScrollableContainerMaxWidth:o.number.isRequired},getInitialState:function(){const{props:e}=this;return{_graphicHeight:null,_graphicWidth:null,_contentHeight:null,_x:0,_y:0}},componentDidMount:function(){this.setInteract(),this.setContentHeight()},componentDidUpdate:function({device:e,menuImageWidth:t}){e.windowHeight===this.props.device.windowHeight&&e.orientation===this.props.device.orientation&&t===this.props.menuImageWidth||(this.setImageWidth(),this.setContentHeight())},componentWillUnmount:function(){c(a.findDOMNode(this._scrollable)).unset()},setInteract:function(){c(a.findDOMNode(this._scrollable)).draggable({onmove:this.onDragMove,onend:this.onDragEnd,ignoreFrom:".ev-map-menu-pointer"})},setImageWidth:function(){const e=this.refs.image.getRef(),{naturalWidth:t,naturalHeight:n}=a.findDOMNode(e),{menuImageWidth:i}=this.props,o=0===i?1024:i,s=o/(t/n);this.setState({_graphicWidth:o,_graphicHeight:s})},setContentHeight:function(){const{windowHeight:e}=this.props.device,{top:n}=t(".ev-container").offset(),i=e-n;this.setState({_contentHeight:i>600?600:i})},getClassName:function(){const{props:e}=this;return r("ev-map-menu-image",{"ev-modal-open":e.isModalOpen})},getScrollableStyle:function(){const{_graphicHeight:e,_graphicWidth:t,_x:n,_y:i}=this.state;return{height:e,width:t,transform:`translate(${n}px, ${i}px)`}},onImageLoaded:function(){this.setImageWidth()},onDragMove:function(e){const{props:t}=this;t.isModalOpen||(t.isDragging||t.onDragStart(),this.setState({_x:this.state._x+e.dx,_y:this.state._y+e.dy}))},onDragEnd:function(){this.props.onDragEnd()},render:function(){const{state:e,props:t}=this;return s.createElement("div",{className:this.getClassName(),style:{height:e._contentHeight,maxWidth:t.menuScrollableContainerMaxWidth}},s.createElement("div",{ref:e=>this._scrollable=e},s.createElement("div",{className:"ev-map-menu-image-container",style:this.getScrollableStyle()},s.createElement(l,{ref:"image",graphicSrc:t.graphic,onLoad:this.onImageLoaded,altText:t.alt}),this.props.children,s.createElement("div",{className:"ev-map-menu-image-overlay"}))))}});e.exports=u}).call(this,n(29))},2167:function(e,t,n){"use strict";const i=n(8),o=n(2),s=n(1),a=n(0),{Motion:r,spring:c}=n(1401),l=n(7),{connect:u}=n(6),m=n(119),p=o({displayName:"MapMenuPointer",propTypes:{item:s.object.isRequired,defaultPointerImage:s.object,onClick:s.func.isRequired,isModalOpen:s.bool.isRequired},getInitialState:function(){return{_isHovering:!1}},onMouseEnter:function(){const{isModalOpen:e}=this.props;e||this.setState({_isHovering:!0})},onMouseLeave:function(){this.setState({_isHovering:!1})},onClick:function(e){const{props:t}=this;e.preventDefault(),t.isModalOpen||t.onClick(t.item)},getPointerImage:function(){const{props:e}=this;return i(e.item,"_mapMenu._pointerImage")||e.defaultPointerImage},getPointerImageStyle:function(){const{props:e}=this,t={},n=i(e.item,"_mapMenu._pointerWidth"),o=e.defaultPointerWidth,s=n||o;return s&&(t.width=s+"px",t.maxWidth="none"),t},getStyle:function({scale:e,opacity:t}){const{props:n}=this,o=i(n.item,"_mapMenu._position",{_top:50,_left:50});return{top:o._top+"%",left:o._left+"%",transform:`translate(-50%, -50%) scale(${e})`,opacity:t}},getMotionStyle:function(){const{state:e,props:t}=this,n=t.isModalOpen?.5:1,i=e._isHovering?1.2:1;return{scale:c(i,{stiffness:175,damping:e._isHovering?12:20}),opacity:c(n)}},render:function(){const{props:e}=this;return a.createElement(r,{defaultStyle:{scale:1,opacity:1},style:this.getMotionStyle()},t=>a.createElement("button",{className:l("ev-map-menu-pointer",{"ev-is-disabled":e.isModalOpen}),style:this.getStyle(t),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onClick,"aria-label":this.props.item.title},a.createElement(m,{graphicSrc:this.getPointerImage(),style:this.getPointerImageStyle()})))}});e.exports=u((e,t)=>({item:e.contentObjects[t.itemId]}))(p)},2168:function(e,t,n){"use strict";const i=n(2),o=n(1),s=n(0),{Spring:a,config:r,animated:c}=n(77),l=n(175),u=n(24),m=i({displayName:"MapMenuInformation",propTypes:{body:o.string,closeButtonText:o.string.isRequired,onInfoCloseClick:o.func.isRequired},onInfoCloseClick:function(e){e.currentTarget.blur(),e.preventDefault(),this.props.onInfoCloseClick()},render:function(){const{props:e}=this;return s.createElement(l,null,s.createElement(a,{native:!0,from:{opacity:0},to:{opacity:1},config:r.default},({opacity:t})=>s.createElement(c.div,{className:"ev-map-menu-information",style:{opacity:t}},s.createElement("button",{className:"ev-map-menu-button ev-map-menu-information-close-button",onClick:this.onInfoCloseClick,"aria-label":e.closeButtonText},s.createElement("i",{className:"ev-icon ev-icon-cross"})),s.createElement("div",{className:"ev-map-menu-information-inner"},s.createElement(u,{className:"ev-map-menu-body",html:e.body,tabIndex:"1"}),s.createElement("div",{className:"ev-map-menu-information-close-button-container"},s.createElement("button",{className:"ev-map-menu-information-close-button-mobile ev-button",onClick:this.onInfoCloseClick},e.closeButtonText))))))}});e.exports=m},2169:function(e,t,n){"use strict";const i=n(2),o=n(1),s=n(0),{Spring:a,config:r,animated:c}=n(77),{MenuItemProgress:l,MenuItemHOC:u,MenuItemLink:m}=n(302),p=n(175),d=n(1387),h=n(143),g=n(33),f=n(63),v=n(24),I=i({displayName:"MapMenuItem",propTypes:{item:o.object.isRequired,closeButtonText:o.string.isRequired,onCloseMenuItemClick:o.func.isRequired,durationIcon:o.string,shouldShowProgressBarsOnMenus:o.bool},onCloseMenuItemClick:function(e){e.preventDefault(),e.currentTarget.blur(),this.props.onCloseMenuItemClick()},renderTitle:function(){const e=d(this.props.item);if(e)return s.createElement(h,{headingElement:"h2",displayTitle:e,className:"ev-map-menu-item-title ev-menu-item-title",innerClassName:"ev-map-menu-item-title-inner ev-menu-item-title-inner"})},renderBody:function(){if(this.props.item.description)return s.createElement(g,{body:this.props.item.description,className:"ev-map-menu-item-body ev-menu-item-body",innerClassName:"ev-map-menu-item-body-inner ev-menu-item-body-inner"})},renderDurationIcon:function(){const{durationIcon:e}=this.props;if(e)return s.createElement("i",{className:"ev-menu-item-duration-icon ev-icon ev-icon-"+e})},renderElements:function(e){const{props:t}=this;return f("menuItem",e,{item:t.item})},render:function(){const{item:e,closeButtonText:t,pageMenuItemsCompletedCount:n,pageMenuItemsCount:i,completedChildrenAsPercentage:o,shouldShowProgressBarsOnMenus:u}=this.props;return s.createElement(p,null,s.createElement(a,{native:!0,from:{opacity:0},to:{opacity:1},config:r.default},({opacity:a})=>s.createElement(c.div,{className:"ev-map-menu-item ev-menu-item ev-collection-item",style:{opacity:a}},s.createElement("button",{className:"ev-map-menu-button ev-map-menu-items-close-button",onClick:this.onCloseMenuItemClick,"aria-label":t},s.createElement("i",{className:"ev-icon ev-icon-cross"})),s.createElement("div",{className:"ev-map-menu-item-inner ev-clearfix"},s.createElement("div",{className:"ev-map-menu-item-content-container ev-collection-item-content-inner"},this.renderTitle(),this.renderBody(),s.createElement("div",{className:"ev-map-menu-item-duration ev-menu-item-duration"},s.createElement("div",{className:"ev-map-menu-item-duration-inner ev-menu-item-duration-inner"},this.renderDurationIcon(),s.createElement("span",{className:"ev-menu-item-duration-label"},e.durationLabel),s.createElement(v,{element:"span",html:e.duration}))),this.renderElements("content"),u&&s.createElement(l,{item:e,pageMenuItemsCompletedCount:n,pageMenuItemsCount:i,completedChildrenAsPercentage:o})),s.createElement("div",{className:"ev-map-menu-item-buttons ev-collection-item-footer"},s.createElement("div",{className:"ev-collection-item-footer-inner"},s.createElement(m,{isLocked:e._isLocked,isVisited:e._isVisited,linkText:e.linkText,linkIcon:e.linkIcon,isLinkIconRightPosition:e.isLinkIconRightPosition,link:`/${e._type}/${e._id}`}),s.createElement("button",{className:"ev-map-menu-item-close-button-mobile ev-button",onClick:this.onCloseMenuItemClick},t)))))))}});e.exports=u(I)}}]);