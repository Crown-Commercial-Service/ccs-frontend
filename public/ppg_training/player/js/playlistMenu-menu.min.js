(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{1307:function(e,t,n){"use strict";const{registerMenu:r,registerReducer:s}=n(4),i=n(2170),o=n(2171);s("playlistMenu",i),r("playlistMenu",o,{shouldFilterChildren:!1,shouldRerenderOnMenuChanged:!1})},1387:function(e,t,n){"use strict";e.exports=function(e){const t=e.displayTitle,n=e._heroImage?e._heroImage.title:null;return t||n}},1591:function(e,t,n){"use strict";t.GROUP_CATEGORY_CHANGED="GROUP_CATEGORY_CHANGED",t.CATEGORY_CHANGED="CATEGORY_CHANGED",t.RESET_CATEGORIES="RESET_CATEGORIES",t.groupCategoryChanged=(e,n)=>({type:t.GROUP_CATEGORY_CHANGED,payload:{groupId:e,categoryId:n}}),t.categoryChanged=e=>({type:t.CATEGORY_CHANGED,payload:{categoryId:e}}),t.resetCategories=()=>({type:t.RESET_CATEGORIES})},2170:function(e,t,n){"use strict";const r=n(98),s=n(139),i=n(39),o=n(43),a=n(93),{SETUP_APP:l}=n(9),{CATEGORY_CHANGED:c,GROUP_CATEGORY_CHANGED:u,RESET_CATEGORIES:d}=n(1591),p={selectedCategory:"all",categories:{},groups:{}};e.exports=(e=p,t)=>{switch(t.type){case l:return function(e,{course:t,settings:n}){if("playlistMenu"!==n._menu)return e;const r=s(t._categories,"_id"),l=i(t._categoryGroups).map(e=>({...e,categories:o(r,e._categories),selectedCategory:"all"})).keyBy("_id").value(),c=i(t._categoryGroups).map(e=>e._categories).flatten().value(),u=a(r,c);return{...p,groups:l,categories:u}}(e,t.payload);case c:return{...e,selectedCategory:t.payload.categoryId};case u:return{...e,groups:{...e.groups,[t.payload.groupId]:{...e.groups[t.payload.groupId],selectedCategory:t.payload.categoryId}}};case d:return{...e,selectedCategory:"all",groups:r(e.groups,e=>({...e,selectedCategory:"all"}))};default:return e}}},2171:function(e,t,n){"use strict";const r=n(173),s=n(142),i=n(32),o=n(43),a=n(141),l=n(31),c=n(8),u=n(2),d=n(1),p=n(0),{connect:m}=n(6),h=n(7),{setAriaLive:g}=n(58),y=n(63),v=n(478),C=n(144),_=n(325),E=n(231),b=n(62),{categoryChanged:I,groupCategoryChanged:R,resetCategories:M}=n(1591),f=n(2172),N=n(2173),T=n(2174),S=n(2175),A=n(2176),k=u({displayName:"PlaylistMenu",propTypes:{course:d.object.isRequired,menu:d.object.isRequired,device:d.object.isRequired,theme:d.object.isRequired,items:d.object.isRequired,location:d.object.isRequired,categories:d.object.isRequired,groups:d.object.isRequired,selectedCategory:d.string.isRequired,categoryChanged:d.func.isRequired,groupCategoryChanged:d.func.isRequired,resetCategories:d.func.isRequired,setAriaLive:d.func.isRequired,hasActionBar:d.bool.isRequired,isShowingHiddenContent:d.bool,history:d.object.isRequired,classList:d.array},getInitialState:()=>({_selectedItemId:null}),componentDidMount(){this.announceMenuAriaLabel()},componentDidUpdate({menu:e}){e._id!==this.props.menu._id&&this.announceMenuAriaLabel()},announceMenuAriaLabel(){const{props:e}=this;e.menu.ariaLabel&&e.setAriaLive({message:e.menu.ariaLabel,delay:200})},getSelectedCategoriesMap(){const{props:e}=this,t=r(e.groups,(e,t)=>("all"!==t.selectedCategory&&(e[t.selectedCategory]=!0),e),{});return"all"!==e.selectedCategory&&(t[e.selectedCategory]=!0),t},getMenuItems(){const{props:e}=this,t=this.getSelectedCategoriesMap(),n=e.menu._id!==e.course._id?e.menu._id:null,r=s(t),l=i(e.items,i=>!(i._isHidden&&!e.isShowingHiddenContent)&&("page"===i._type&&((!n||i._parentId===n)&&(!r||s(o(t,i._categories))===r))));return a(l,"_contentObjectOrder")},getAvailableMenus(){return i(this.props.items,e=>"menu"===e._type)},getClassName(){const{props:e}=this;return h("ev-playlist-menu ev-menu",e.classList,{"ev-use-menu-header-styles":e.theme._menu._settings._useMenuHeaderStyles,"ev-disable-inner-flex":e.theme._footer._settings._isStickyFooterDisabled})},getIsMenuReady(){const{menu:e,location:t}=this.props;return!(!e._isReady||!t.isLocationReady)},onResetCategories(e){e.preventDefault(),e.currentTarget.blur();const{props:t}=this;t.resetCategories(),t.history.replace("/menu/"+t.course._id)},onCategoryChanged(e){this.props.categoryChanged(e)},onGroupCategoryChanged(e,t){this.props.groupCategoryChanged(e,t)},onMenuChanged(e){const{props:t}=this,n="all"===e?t.course._id:e;t.history.push("/menu/"+n)},onShowItemContent(e){this.setState({_selectedItemId:e})},renderGroupFilters(){return s(this.props.groups)?l(this.props.groups,e=>p.createElement(N,{key:e._id,group:e,allText:c(this.props.course,"_playlistMenu.allText","All"),onChange:this.onGroupCategoryChanged})):null},renderMenuSelect(e){if(!e.length)return;const{props:t}=this;return p.createElement(T,{items:e,value:t.menu._id===t.course._id?"all":t.menu._id,allText:c(this.props.course,"_playlistMenu.allText","All"),onChange:this.onMenuChanged})},renderFullPlaylistButton(e){if(!e)return;const{props:t}=this;return p.createElement("button",{onClick:this.onResetCategories,className:"ev-category-button ev-button ev-primary"},c(t.course,"_playlistMenu._fullPlaylist"))},renderFilters(){const{props:e}=this,t=this.getAvailableMenus(),n=this.renderGroupFilters(),r=this.renderMenuSelect(t),i=this.renderFullPlaylistButton(!s(e.categories)&&(n||r));if(n||r)return p.createElement("div",{className:"ev-categories-action-bar-items"},n,r,i)},renderCategoryButtons(){if(!s(this.props.categories))return null;const{props:e}=this;return p.createElement("div",{className:"ev-categories-action-bar-items"},l(e.categories,t=>p.createElement(S,{key:t._id,category:t,isSelected:e.selectedCategory===t._id,onClick:this.onCategoryChanged})),this.renderFullPlaylistButton(!0))},renderActionBar(){const e=this.renderFilters(),t=this.renderCategoryButtons();if(e||t)return p.createElement("div",{className:"ev-categories-action-bar ev-action-bar"},p.createElement("div",{className:"ev-action-bar-inner"},e,t))},getShouldShowProgressBars(){const{props:e}=this,t=c(e.theme,"_menu._settings._shouldShowProgressBarsOnMenus","content"),n=c(e.menu,"_playlistMenu._shouldShowProgressBarsOnMenus",!0);return"content"===t?n:"true"===t},renderItems(){const{props:e,state:t}=this,n=this.getMenuItems(),r=c(e.theme,"_menu._settings._durationIcon",null);return l(n,n=>p.createElement(A,{key:n._id,itemId:n._id,device:e.device,durationIcon:r,shouldShowProgressBarsOnMenus:this.getShouldShowProgressBars(),isContentVisible:t._selectedItemId===n._id,onShowItemContent:this.onShowItemContent}))},renderElements(e){const{props:t}=this;return y("menu",e,{menu:t.menu})},renderHeroImage(e){const t=c(this.props,"menu._playlistMenu._heroImage");if(t)return p.createElement(E,{title:t.title,body:t.body,graphic:t._graphic,_contentWidth:t._contentWidth,layout:t.layout,floatingGraphic:t._floatingGraphic,parentSelector:".ev-menu-container-inner",contentObjectType:"menu",theme:this.props.theme,isReady:e})},render(){const{props:e}=this,t=C(),n=this.getIsMenuReady();return p.createElement("div",{className:this.getClassName()},p.createElement(_,{backgroundImage:c(e.menu,"_playlistMenu._desktopBackgroundImage"),mobileBackgroundImage:c(e.menu,"_playlistMenu._mobileBackgroundImage")}),v(e.menu),p.createElement("main",{className:"ev-menu-container",style:{minHeight:`calc(100vh - ${t})`}},p.createElement("div",{className:"ev-menu-root"},this.renderElements("root")),p.createElement("div",{className:"ev-menu-container-inner"},p.createElement(b.Provider,{value:e.menu.displayTitle?2:1},this.renderHeroImage(n)),p.createElement(f,{menu:e.menu,theme:e.theme,hasActionBar:this.props.hasActionBar}),p.createElement(b.Provider,{value:2},p.createElement("div",{className:"ev-action-bar-container"},this.renderElements("actionBar")),this.renderActionBar(),p.createElement("div",{className:"ev-menu-items"},p.createElement("div",{className:"ev-menu-items-inner ev-clearfix"},this.renderItems())))),p.createElement("div",{className:"ev-menu-footer"},this.renderElements("footer"))))}});e.exports=m(e=>({...e.playlistMenu,items:e.contentObjects}),{setAriaLive:g,categoryChanged:I,groupCategoryChanged:R,resetCategories:M})(k)},2172:function(e,t,n){"use strict";const r=n(2),s=n(1),i=n(0),o=n(498),a=n(303),l=n(170),c=n(318),u=n(7),d=n(33),p=n(24),m=r({displayName:"PlaylistMenuHeader",propTypes:{menu:s.object.isRequired,theme:s.object.isRequired,hasActionBar:s.bool.isRequired},renderTitle(){if(this.props.menu.displayTitle)return i.createElement("div",{className:"ev-menu-title ev-header-title"},i.createElement(p,{element:"h1",className:"ev-menu-title-inner ev-header-title-inner",html:this.props.menu.displayTitle,style:o(this.props.menu._displayTitleSettings,this.props.theme._swatches)}))},renderBody(){if(this.props.menu.body)return i.createElement(d,{className:"ev-menu-body ev-header-body",innerClassName:"ev-menu-body-inner ev-header-body-inner",hasInner:!0,body:this.props.menu.body})},getStyle(e){var t;const n=null===(t=e._playlistMenu)||void 0===t?void 0:t._backgroundImage;if(!n||!l(n.src,n.srcAdvanced))return c(!0);const{src:r,srcAdvanced:s}=n;return{backgroundImage:`url("${a(r,s,!0)}")`,minHeight:"350px"}},render(){const{menu:e}=this.props;return e.displayTitle||e.body?i.createElement("div",{className:u("ev-menu-header ev-header",{"ev-header-with-action-bar":this.props.hasActionBar}),style:this.getStyle(e)},i.createElement("div",{className:"ev-menu-header-inner ev-header-inner ev-clearfix ev-no-graphic"},i.createElement("div",{className:"ev-menu-header-content ev-header-left"},this.renderTitle(),this.renderBody()))):null}});e.exports=m},2173:function(e,t,n){"use strict";const r=n(31),s=n(2),i=n(1),o=n(0),a=s({displayName:"PlaylistGroupSelect",propTypes:{allText:i.string.isRequired,group:i.shape({_id:i.string.isRequired,name:i.string.isRequired,categories:i.object.isRequired,selectedCategory:i.string}).isRequired,onChange:i.func.isRequired},render(){const{allText:e,group:t,onChange:n}=this.props;return o.createElement("div",{className:"ev-playlist-group-select"},o.createElement("label",null,t.name,o.createElement("select",{id:t._id,value:t.selectedCategory,onChange:({target:e})=>n(t._id,e.value)},o.createElement("option",{value:"all"},e),r(t.categories,({_id:e,name:t})=>o.createElement("option",{value:e,key:e},t)))))}});e.exports=a},2174:function(e,t,n){"use strict";const r=n(31),s=n(2),i=n(1),o=n(0),a=s({displayName:"PlaylistMenuSelect",propTypes:{label:i.string,allText:i.string.isRequired,items:i.array.isRequired,onChange:i.func.isRequired,value:i.string.isRequired},getDefaultProps:()=>({label:"Topic"}),render(){return o.createElement("div",{className:"ev-playlist-group-select"},o.createElement("label",null,this.props.label,o.createElement("select",{value:this.props.value,onChange:({target:e})=>this.props.onChange(e.value),id:"ev-playlist-menu-select"},o.createElement("option",{value:"all",key:"all"},this.props.allText),r(this.props.items,e=>{const t=e._playlistMenu?e._playlistMenu._menuDropdownTitle:null;return o.createElement("option",{key:e._id,value:e._id},t||e.title)}))))}});e.exports=a},2175:function(e,t,n){"use strict";const r=n(2),s=n(1),i=n(0),o=n(7),a=r({displayName:"PlaylistCategoryButton",propTypes:{category:s.object.isRequired,onClick:s.func.isRequired,isSelected:s.bool},onClick(e){e.preventDefault(),e.currentTarget.blur(),this.props.onClick(this.props.category._id)},render(){return i.createElement("button",{className:o("ev-category-button ev-button ev-primary",{"ev-is-selected":this.props.isSelected}),onClick:this.onClick},this.props.category.name)}});e.exports=a},2176:function(e,t,n){"use strict";const r=n(2),s=n(1),i=n(0),o=n(48),a=n(7),l=n(1387),c=n(478),u=n(63),d=n(143),p=n(33),{MenuItemProgress:m,MenuItemHOC:h,MenuItemDuration:g,MenuItemLink:y}=n(302),v=n(303),C=n(170),_=n(64),E=n(62),b=r({displayName:"PlaylistMenuItem",propTypes:{item:s.object.isRequired,device:s.object.isRequired,durationIcon:s.string,shouldShowProgressBarsOnMenus:s.bool,isContentVisible:s.bool.isRequired,isVisibleItem:s.bool,pageMenuItemsCount:s.number,pageMenuItemsCompletedCount:s.number,completedChildrenAsPercentage:s.number},getInitialState:()=>({_height:window.innerHeight}),componentDidMount(){this.updateSizes()},UNSAFE_componentWillReceiveProps({device:e}){e!==this.props.device&&this.updateSizes()},updateSizes(){const e=o.findDOMNode(this).offsetWidth;this.setState({_height:e})},onClick(e){const{item:t}=this.props;t._isLocked&&e.preventDefault()},renderTitle(){const e=l(this.props.item);if(e)return i.createElement(d,{headingElement:"h"+this.context,displayTitle:e,className:"ev-menu-item-title",innerClassName:"ev-menu-item-title-inner"})},renderBody(){if(this.props.item.description)return i.createElement(p,{body:this.props.item.description,className:"ev-menu-item-body",innerClassName:"ev-menu-item-body-inner"})},renderDuration(){const{duration:e,durationLabel:t}=this.props.item;if(e)return i.createElement(g,{duration:e,durationIcon:this.props.durationIcon,durationLabel:t})},renderProgress(){const{props:e}=this;if(null!=e&&e.shouldShowProgressBarsOnMenus)return i.createElement(m,{item:e.item,pageMenuItemsCompletedCount:e.pageMenuItemsCompletedCount,pageMenuItemsCount:e.pageMenuItemsCount,completedChildrenAsPercentage:e.completedChildrenAsPercentage})},renderLink(){const{item:e}=this.props;return i.createElement(y,{isLocked:e._isLocked,isVisited:e._isVisited,linkText:e.linkText,linkIcon:e.linkIcon,isLinkIconRightPosition:e.isLinkIconRightPosition,link:`/${e._type}/${e._id}`})},getStyle(){var e,t;const n={height:this.state._height+"px"},r=null===(e=this.props.item)||void 0===e||null===(t=e._playlistMenu)||void 0===t?void 0:t._graphic;return r&&C(r.src,r.srcAdvanced)?(n.backgroundImage=`url("${v(r.src,r.srcAdvanced,!0)}")`,n):n},getItemClass(){return a("ev-menu-item ev-collection-item","ev-menu-item-"+this.props.item._id,{"ev-is-visible-item":this.props.isVisibleItem,"ev-is-content-visible":this.props.isContentVisible})},renderElements(e){const{props:t}=this;return u("menuItem",e,{item:t.item})},render(){return i.createElement(_,{id:this.props.item._id,name:"menu item",className:this.getItemClass(),style:this.getStyle()},this.renderElements("root"),c(this.props.item,"menuitem"),i.createElement("div",{className:"ev-menu-item-inner ev-collection-item-inner"},i.createElement("div",{className:"ev-collection-item-content"},i.createElement("div",{className:"ev-collection-item-content-inner ev-clearfix"},this.renderTitle(),i.createElement("div",{className:"ev-menu-item-hidden-content"},this.renderBody(),this.renderDuration(),this.renderElements("content"),this.renderProgress(),this.renderLink())))))}});b.contextType=E,e.exports=h(b)}}]);